Based on: https://code.msdn.microsoft.com/Using-Print-Preview-Print-eb188e3c